
# Login
//Genera las vistas y las rutas para un login y registro basico, necesario ejecutar al principio del desarrollo, ya que genera algunos archivos que pueden interferir con el desarrollo.

		php artisan make:auth  

Si necesitamos revisar las opciones 
	php artisan -h make:auth

Para laravel 9, y 10' queremso aplicar nuestros login personalizado y aplicar las directivas de seguridad y autentificacion de usuarios.


En Laravel 12, el comando php artisan make:auth ya no existe y fue eliminado desde Laravel 6 en adelante. En versiones modernas como Laravel 12, la autenticación se maneja utilizando Laravel Breeze, Laravel Jetstream, Laravel Fortify, o Laravel UI, según tus necesidades.



Solución recomendada: Instalar Laravel Breeze
--------------------------------------------

Laravel Breeze es una implementación mínima y moderna de autenticación que es ideal para comenzar.
1. Instalar Breeze

composer require laravel/breeze --dev

2. Generar los archivos de autenticación

php artisan breeze:install

3. Ejecutar migraciones

php artisan migrate

4. Instalar y compilar los assets (requiere Node.js y npm)

npm install && npm run dev

5. Levantar el servidor de desarrollo

php artisan serve

Ahora ya tendrás un sistema de autenticación básico con vistas Blade en tu proyecto Laravel 12.



Alternativas a Breeze -> Laravel UI
-----------------------------------

Laravel Jetstream es más robusto, incluye gestión de sesiones, autenticación de dos factores, entre otras caracteristicas

En nuestro caso vamos a implementar Laravel Laravel UI para seguir usando Bootstrap/jQuery y el sistema de vistas Blade clásico.

Para usar laravel/ui, ejecutamos los siguientes comandos:

    $ composer require laravel/ui

Esto modificara el composer.json, composer.lock para agregar los nuevos paquetes a nuestra aplicación en nuestro caso sera la version 4.6 de Larvel/UI

Instalamos el paquete con:

    $ php artisan ui bootstrap --auth

Esto nos sustituira el controlador Controller.php, como nuestra aplicación es recien creada no existe mayor probvlema, pero si ya tenemos modificadas las clases y metodos en este controlador, debemos respaldar por que sera sustituido.

app/Http/Auth/Conntroller.php

Yaque se la autentificacion escalfoldingy boostrap,



Con el comando anterior y la creación del scaffolding tenemos los siguientes archivos

  resources/js/bootstrap.js
  routes/web.php
  vite.config.js

Y los archivos para trabajar:

    app/Http/Controllers/Auth/                                                  => Controlador de autenticación
    app/Http/Controllers/HomeController.php                                     => Controlador de inicio
    database/migrations/2014_10_12_100000_create_password_resets_table.php      => Migracion para la autenticacion
    resources/sass/                                                             => Recursos SASS
    resources/views/auth/                                                       => Vistas de autenticacion
    resources/views/home.blade.php                                              => Plantilla de inicio
    resources/views/layouts/                                                    => Vistas del layout

    

ahora debemos ejecutar el siguiente comando para compilar el scaffolding
    $ npm install && npm run dev

Scaffold es una herramienta que nos ofrece Laravel para poder generar una estructura básica del CRUD de un modelo en nuestros proyectos.

CRUD

El término CRUD representa las cuatro operaciones básicas de una aplicación web:

Crear (Create), Leer (Read), Actualizar (Update) y Eliminar (Delete)

Tradicionalmente lo que hariamos sería escribir manualmente cada uno de los componentes necesarios para crear el CRUD, esto significa definir el controlador, el modelo, las vistas y las rutas uno por uno.  

Con solo una simple línea de comando, generamos automáticamente el conjunto de controladores, modelos, vistas y rutas necesarios para administrar ese modelo en la base de datos.


Como se creao una nueva mocgración para los usuarios debemos ejecutar nuevamente las igraciones pendientes.
    $ php artisan migrate



El comando 

   $php artisan ui bootstrap --auth genera un scaffolgind para trabajar con autenticación, para ello 

Dentro de las vistas generara los siguiente;

resources/views/auth/
	/passwords				Recuperqcion de contraseña
	login.blade.php			login de acceso
	register.blade.php		recuperación de contraseña
    verify.blade.php        Verificacion de autenticación



En el archivo de rutas web.php
Si agregamos la ruta auth

    Route::auth();  Metodo especial para crear las tutas para registro, login y recuperacion de contraseña


En el navegador podemos ahora tener el formulario de loin desde

    localhost/login

Ahora tenemos un avista de Login con Laravel UI, tenemos tambien register

    localhost/register

Cuando ejecutamos el comando inicial para la creación de nuestro login, estas vistas aparecen con bootstrap CSS.

Vamos a deshabilitar el registro de usuarios





Tiene las siguientes opciones:

-- views para generar las vistas de autenticación

Ejecutamos

	$ php artisan make:auth --views

Si despues de haber cipiado las rutas de login

//Rutas de autenticacion
Route::get('login','Auth\LoginController@showLoginForm')->name('login');
Route::post('login','Auth\LoginController@login');
Route::post('logout','Auth\LoginController@logout')->name('logout');

Y vamos a localhost:login, nos generara un erro, no indicara que no existe y esto es por que en la vista login, estamos estendiendo 
layout.app y si abrirmos
    app.blade.php buscando register, es donde se hace referencia a la ruta que no existe de register

    /home/klvst3r/dev/laravel/travelblog/resources/views/layouts/app.blade.php


No indica un error

    Target class [Auth\LoginController] does not exist

significa que Laravel no puede encontrar la clase Auth\LoginController porque la notación de la ruta es antigua o incorrecta para Laravel 8 en adelante, donde se usa PHP 8 con auto-importación de clases (resolución por namespaces).


Agrega use al principio del archivo routes/web.php

use App\Http\Controllers\Auth\LoginController;
use App\Http\Controllers\Auth\RegisterController;

Y luego en tus rutas:

// Rutas de autenticación modernas
Route::get('login', [LoginController::class, 'showLoginForm'])->name('login');
Route::post('login', [LoginController::class, 'login']);
Route::post('logout', [LoginController::class, 'logout'])->name('logout');

Opción 2: Usar el namespace completo directamente estas estaran comentadas momentaneamante

// Route::get('login', [App\Http\Controllers\Auth\LoginController::class, 'showLoginForm'])->name('login');
// Route::post('login', [App\Http\Controllers\Auth\LoginController::class, 'login']);
// Route::post('logout', [App\Http\Controllers\Auth\LoginController::class, 'logout'])->name


Si también necesitas registro, agrega:

//use App\Http\Controllers\Auth\RegisterController;

//Route::get('register', [RegisterController::class, 'showRegistrationForm'])->name('register');
//Route::post('register', [RegisterController::class, 'register']);

Ahora vamos a login:8000/login y el problema se habra solucionado.

no se va a utilizar el archivo

layout/app.blade.php

Por que tenemos la plantilla de administración admin.layout

cambiamos por
    @extends('admin.layout')

Ahora nuestro login tiene nuestro layout de administración    

Modificación del Template 
    login.blade.php

Adecuación de estilos, y contenidos del formulario, token y metodos del formualario.



Clonar del proyecto despues del login
-----------------------

Nuestro proyecto se ha actualizado en un equipo diferente del que se creo, 

 git pull origin login
From github.com:Klvst3r/travelblog
 * branch            login      -> FETCH_HEAD
Updating d958c0a..4fba705
Fast-forward
 README.md                                                             |   11 +-
 app/Http/Controllers/Auth/ConfirmPasswordController.php               |   39 +
 app/Http/Controllers/Auth/ForgotPasswordController.php                |   22 +
 app/Http/Controllers/Auth/LoginController.php                         |   40 +
 app/Http/Controllers/Auth/RegisterController.php                      |   72 +
 app/Http/Controllers/Auth/ResetPasswordController.php                 |   29 +
 app/Http/Controllers/Auth/VerificationController.php                  |   41 +
 app/Http/Controllers/HomeController.php                               |   28 +
 composer.json                                                         |    3 +-
 composer.lock                                                         |   65 +-
 .../migrations/2014_10_12_100000_create_password_resets_table.php     |   32 +
 doc/login/1. Login                                                    |  217 +
 package-lock.json                                                     | 1666 +++++
 package.json                                                          |    3 +
 public/dashboard/bootstrap/css/bootstrap.css                          |    2 +-
 public/dashboard/build/css/bootstrap.css                              | 9727 ++++++++++++++++++++++++++++++
 public/dashboard/build/css/bootstrap.min.css                          |    7 +
 public/dashboard/build/css/custom.css                                 |  225 +-
 public/dashboard/build/css/style.css                                  | 4921 +++++++++++++++
 public/dashboard/build/css/style_002.css                              |  208 +
 public/img/escudo-gris.png                                            |  Bin 0 -> 78014 bytes
 resources/js/bootstrap.js                                             |    4 +-
 resources/sass/_variables.scss                                        |    7 +
 resources/sass/app.scss                                               |    8 +
 resources/views/admin/layout.blade.php                                |    2 +-
 resources/views/auth/login.blade.php                                  |  128 +
 resources/views/auth/login_backup.blade.php                           |   74 +
 resources/views/auth/passwords/confirm.blade.php                      |   49 +
 resources/views/auth/passwords/email.blade.php                        |   47 +
 resources/views/auth/passwords/reset.blade.php                        |   65 +
 resources/views/auth/register.blade.php                               |   77 +
 resources/views/auth/verify.blade.php                                 |   28 +
 resources/views/home.blade.php                                        |   23 +
 resources/views/layouts_backup/app.blade.php                          |   80 +
 routes/web.php                                                        |   36 +
 vite.config.js                                                        |    5 +-
 36 files changed, 17968 insertions(+), 23 deletions(-)
 create mode 100644 app/Http/Controllers/Auth/ConfirmPasswordController.php
 create mode 100644 app/Http/Controllers/Auth/ForgotPasswordController.php
 create mode 100644 app/Http/Controllers/Auth/LoginController.php
 create mode 100644 app/Http/Controllers/Auth/RegisterController.php
 create mode 100644 app/Http/Controllers/Auth/ResetPasswordController.php
 create mode 100644 app/Http/Controllers/Auth/VerificationController.php
 create mode 100644 app/Http/Controllers/HomeController.php
 create mode 100644 database/migrations/2014_10_12_100000_create_password_resets_table.php
 create mode 100644 doc/login/1. Login
 create mode 100644 package-lock.json
 create mode 100644 public/dashboard/build/css/bootstrap.css
 create mode 100644 public/dashboard/build/css/bootstrap.min.css
 create mode 100644 public/dashboard/build/css/style.css
 create mode 100644 public/dashboard/build/css/style_002.css
 create mode 100644 public/img/escudo-gris.png
 create mode 100644 resources/sass/_variables.scss
 create mode 100644 resources/sass/app.scss
 create mode 100644 resources/views/auth/login.blade.php
 create mode 100644 resources/views/auth/login_backup.blade.php
 create mode 100644 resources/views/auth/passwords/confirm.blade.php
 create mode 100644 resources/views/auth/passwords/email.blade.php
 create mode 100644 resources/views/auth/passwords/reset.blade.php
 create mode 100644 resources/views/auth/register.blade.php
 create mode 100644 resources/views/auth/verify.blade.php
 create mode 100644 resources/views/home.blade.php
 create mode 100644 resources/views/layouts_backup/app.blade.php

enciendo el servidor con
php artisan serve --port=8000 y ahora intento visualizar mis cambios del login en la ruta:
http://localhost:8000/login

Marcandome el siguiente error:
Symfony \ Component \ ErrorHandler \ Error \ FatalError
PHP 8.2.28
10.48.29
Trait "Illuminate\Foundation\Auth\AuthenticatesUsers" not found


El error:

    Trait "Illuminate\Foundation\Auth\AuthenticatesUsers" not found

significa que Laravel no encuentra el trait AuthenticatesUsers, el cual es esencial para el funcionamiento del LoginController.

Causa más común

Esto normalmente ocurre cuando:

    Faltan dependencias necesarias, particularmente si no se ha ejecutado composer install después de clonar o actualizar el repositorio.

    El archivo del trait no existe (lo cual es raro si estás usando Laravel UI).

    El autoload de Composer está desactualizado.

Para dar solución ejecutamos:


    $ composer install

Esto descargará todas las dependencias necesarias, incluidas las del sistema de autenticación (como el trait AuthenticatesUsers).

2. (Opcional pero recomendable): Limpia y regenera el autoload

    $ composer dump-autoload

3. Verifica el Trait

Abrimos el archivo app/Http/Controllers/Auth/LoginController.php y asegúrate de que tengas esta línea:

    use Illuminate\Foundation\Auth\AuthenticatesUsers;

Y que esté siendo usado:

    class LoginController extends Controller
    {
        use AuthenticatesUsers;
    }

4. Reinicia el servidor

Después de estos pasos, vuelve a correr:

php artisan serve --port=8000

Y prueba de nuevo la ruta:

http://localhost:8000/login


Conesto debera solucionar el problema.


Si no se tiene Laravel UI instalado aún en el equipo nuevo, debemos asegúrarnos de instalarlo (solo una vez):

    $ composer require laravel/ui


Ahora en RegisterController debemos dirigi a rai en lugar de home

    protected $redirectTo = '/home';


Lo mismo en LoginController que es el encargado de gestionarl el login, 

    protected $redirectTo = '/';

Ahora ya si actualizamos el home, este ya no existira mas, volvemos a inicio y aunque estemos autenticados no habra forma de saberlo.



En login.blade.php

queda nuestros cuadros de texto de la siguiente manera:

<div class="form-group {{ $errors->has('email') ? 'has-error' : '' }} has-feedback">
    <input id="email" type="email" class="form-control @error('email') is-invalid @enderror" name="email" value="{{ old('email') }}" required autocomplete="email" autofocus placeholder="Correo electronico">


Es necesari darle el nombre email y el valor old lo que hara es que al valor que ingresemos persista en caso de que haya un error de validación.

Par ano tener que volver a escribirlo,

Reuired es para que no nos permita enviar el campo vacio.
Autofocus para que el cursor se hubique en este campo y podemas comenzar a escribir inmediatamente  despues de cargar la pagina, copiamos ey en el input pegamos, 
en la siguiente sección 

     @error('email')
        <span class="invalid-feedback" role="alert">
            <strong>{{ $message }}</strong>
        </span>
    @enderror

Es donde se muestran los errores de vaicación, copiamos y pegamos debajo del input

Ahora con el Password, dejando el name y el required

Tambenel campo password lleva si contexto para el manejo de errores.

 @error('password')
    <span class="invalid-feedback" role="alert">
        <strong>{{ $message }}</strong>
    </span>
@enderror


No incluiremos recordar pass






